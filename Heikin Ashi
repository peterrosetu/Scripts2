// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© Edward

//@version=6
indicator('Heikin Ashi', overlay = false)

ha_open = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, open)
ha_high = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, high)
ha_low = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, low)
ha_close = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, close)

bool HideCandles = input.bool(false, title = "Hide Candles")
bool BarColor = input.bool(false, title = "Bar Color")
float Precision = input.float(0.25, title="Doji's Max Body size", step = 0.01)

int doji = (math.abs(ha_open - ha_close) <= (ha_high - ha_low) * Precision ? 1 : 0)

color white = color.rgb(255, 255, 255, 50)
color trans = color.rgb(255, 255, 255, 100)

plotcandle(ha_open < ha_close and not HideCandles ? ha_open : na, ha_high, ha_low, ha_close, title = 'Green Candles', color = doji == 1 ? #eda643 : white, wickcolor = doji == 1 ? #eda643 : white, bordercolor = doji == 1 ? #eda643 : white)
plotcandle(ha_open >= ha_close and not HideCandles ? ha_open : na, ha_high, ha_low, ha_close, title = 'Red Candles', color = doji == 1 ? #eda643 : trans, wickcolor = doji == 1 ? #eda643 : white, bordercolor = doji == 1 ? #eda643 : white)

barcolor(BarColor and doji == 1 ? #eda643 : na)
